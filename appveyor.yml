image: Ubuntu
configuration: Release


environment:
    Compiler: cygwin
    Arch: x64
 
install:
  ## Download nasm
  - sudo apt-get install nasm
  ## Prepare cmake
  - cd ${APPVEYOR_BUILD_FOLDER}
  - mkdir cmake_build

before_build:
  - cd cmake_build
  - cmake --version

build_script: 
  - cmake .. -G "Unix Makefiles" -DPNG_SUPPORTED=NO
  - make

after_build:
# Theres currently a bug with appveyor, it crashes on uploading symlinked artifacts
    find . -type l -delete

artifacts:
- path: cmake_build\**\libturbojpeg*.*
